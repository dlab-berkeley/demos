<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>D-Lab - Web APIs Tutorial</title>
<style>
  :root{
    --bg:#ffffff;
    --panel:#f8f9fa;
    --muted:#6c757d;
    --text:#212529;
    --blue:#0d6efd;
    --indigo:#6610f2;
    --emerald:#198754;
    --orange:#fd7e14;
    --border:#dee2e6;
    --red:#dc3545;
    --yellow:#ffc107;
    --purple:#6f42c1;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background:var(--bg); color:var(--text);
    line-height: 1.6; min-height: 100vh; padding: 20px;
  }
  .wrap{max-width:1200px;margin:32px auto;padding:0 20px}
  .container{
    background: white; border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 40px;
  }
        
  .course-header{text-align:center;margin-bottom:20px;padding:16px;background:var(--panel);border-radius:12px;border:1px solid var(--border)}
  .course-logo{width:180px;height:auto;margin-bottom:8px}
  .course-title{font-size:1.2em;color:var(--blue);margin:0;font-weight:600}
  h1{font-size:32px;margin:0 0 12px; text-align: center;}
  p.lead{color:var(--muted);margin:0 0 24px; font-size: 18px; text-align: center;}
  .intro{
    background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:24px;
    margin-bottom: 24px; box-shadow:0 2px 8px rgba(0,0,0,.1);
  }
  .intro h2{margin:0 0 12px; color:var(--blue);}
  .intro p{margin:12px 0; font-size: 16px;}
  .stage{
    border:1px solid var(--border); border-radius:16px; padding:24px; 
    background:var(--bg); margin-bottom:24px;
    box-shadow:0 2px 8px rgba(0,0,0,.1);
  }
  .stage h2{margin:0 0 12px; font-size:20px; color:var(--blue);}
  .stage .explanation{
    font-size:15px; color:var(--text); margin-bottom:16px; 
    background:rgba(13,110,253,.08); padding:12px 16px; border-radius:12px;
    border-left: 4px solid var(--blue);
  }
  .goal{
    background:rgba(255,179,102,.1); border:1px solid rgba(255,179,102,.3); 
    border-radius:12px; padding:16px; margin:16px 0;
  }
  .goal h3{margin:0 0 8px; color:var(--orange);}
  
  /* Step numbers */
  .step-number{
    display: inline-flex; align-items: center; justify-content: center;
    width: 24px; height: 24px; border-radius: 50%; background: var(--blue);
    color: white; font-weight: bold; font-size: 12px; margin-right: 8px;
  }
  
  /* Buttons */
  .btn{
    display: inline-flex; align-items: center; gap: 8px; padding: 10px 14px;
    border-radius: 12px; border: 1px solid var(--border); background: var(--panel);
    color: var(--text); cursor: pointer; font-size: 14px; margin: 4px;
    transition: all 0.3s ease; text-decoration: none;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .btn:hover{background: var(--bg); transform: translateY(-1px); box-shadow: 0 2px 6px rgba(0,0,0,0.15);}
  .btn-primary{background: var(--blue); color: white; border-color: var(--blue);}
  .btn-primary:hover{background: #0b5ed7; border-color: #0b5ed7;}
  .btn.active{background: var(--emerald); color: white; border-color: var(--emerald);}
  
  /* API Demo Styles */
  .api-demo{
    background: var(--panel); border: 1px solid var(--border);
    border-radius: 12px; padding: 20px; margin: 20px 0;
  }
  .endpoint{
    background: var(--bg); border: 1px solid var(--border);
    border-radius: 8px; padding: 15px; margin: 10px 0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas;
  }
  .method{
    display: inline-block; padding: 4px 8px; border-radius: 4px;
    font-size: 12px; font-weight: bold; margin-right: 10px;
  }
  .method.get{background: rgba(25,135,84,.2); color: var(--emerald);}
  .method.post{background: rgba(255,193,7,.2); color: #856404;}
  .method.put{background: rgba(102,16,242,.2); color: var(--indigo);}
  .method.delete{background: rgba(220,53,69,.2); color: var(--red);}
  
  .response-container{
    background: #f8f9fa; border: 1px solid var(--border);
    border-radius: 8px; padding: 15px; margin: 15px 0;
    max-height: 300px; overflow-y: auto;
  }
  .response-header{
    font-size: 13px; color: var(--muted); margin-bottom: 10px;
    font-weight: 600;
  }
  .response-content{
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas;
    font-size: 13px; white-space: pre-wrap;
  }
  
  /* Interactive Controls */
  .controls{
    display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px; margin: 20px 0;
  }
  .control-group{
    display: flex; flex-direction: column; gap: 8px;
  }
  .control-label{
    font-size: 14px; font-weight: 600; color: var(--text);
  }
  select, input{
    padding: 10px; border: 1px solid var(--border);
    border-radius: 8px; font-size: 14px; background: var(--bg);
  }
  select:focus, input:focus{
    outline: none; border-color: var(--blue);
    box-shadow: 0 0 0 3px rgba(13,110,253,.1);
  }
  
  /* Rate Limiting Display */
  .rate-limit{
    display: flex; align-items: center; gap: 15px;
    background: rgba(255,193,7,.1); border: 1px solid var(--yellow);
    border-radius: 8px; padding: 15px; margin: 15px 0;
  }
  .rate-meter{
    flex: 1; height: 20px; background: var(--panel);
    border-radius: 10px; overflow: hidden; position: relative;
  }
  .rate-fill{
    height: 100%; background: linear-gradient(90deg, var(--emerald), var(--yellow), var(--red));
    border-radius: 10px; transition: width 0.3s ease;
  }
  .rate-text{
    font-size: 13px; font-weight: 600;
  }
  
  /* Authentication Styles */
  .auth-demo{
    background: rgba(102,16,242,.05); border: 1px solid rgba(102,16,242,.2);
    border-radius: 12px; padding: 20px; margin: 20px 0;
  }
  .api-key{
    background: var(--bg); border: 1px solid var(--border);
    border-radius: 6px; padding: 10px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas;
    font-size: 13px; word-break: break-all; margin: 10px 0;
  }
  
  @media (max-width: 768px) {
    .container{padding: 20px;}
    h1{font-size: 1.8em;}
    .controls{grid-template-columns: 1fr;}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="container">
        <div class="course-header">
            <img src="img/dlab-bubble-logo-2025.png" alt="D-Lab Logo" class="course-logo">
        </div>
        <h1>Understanding Web APIs</h1>
        <p class="lead">Learn how applications communicate across the internet</p>
        
        <div class="intro">
            <p><strong>Web APIs</strong> (Application Programming Interfaces) are the bridges that allow different software applications to communicate with each other over the internet. They define the rules, protocols, and tools for how applications can request and exchange data.</p>
            
            <div class="goal">
                <h3>Learning Objectives</h3>
                <p>You'll understand REST principles, API authentication, rate limiting, and how to work with real APIs through hands-on demonstrations using a weather API example.</p>
            </div>

            <div style="background: rgba(25,135,84,.1); border: 1px solid rgba(25,135,84,.3); border-radius: 12px; padding: 16px; margin: 16px 0;">
                <h4 style="color: var(--emerald); margin: 0 0 8px;">Real-world analogy:</h4>
                <p style="margin: 0;">Think of APIs like a restaurant menu and waiter. The menu (API documentation) tells you what you can order and how. You make requests to the waiter (API endpoint) who brings back your food (data) from the kitchen (server).</p>
            </div>
            <button class="btn btn-primary" onclick="showRestBasics()" style="margin-top: 15px;">Next: REST API Basics ‚Üí</button>
        </div>
        
        <div class="stage" id="rest-stage" style="display: none;">
            <h2><span class="step-number">1</span>REST API Fundamentals</h2>
            <div class="explanation">
                REST (Representational State Transfer) is the most common architectural style for web APIs. It uses standard HTTP methods and follows predictable URL patterns to perform operations on resources. We'll use a fictional weather API (api.example-weather.com) as our example throughout this lesson.
            </div>
            
            <div class="api-demo">
                <h4 style="color: var(--blue); margin: 0 0 15px;">HTTP Methods & Their Purposes</h4>
                
                <div class="endpoint">
                    <div class="method get">GET</div>
                    <span>https://api.example-weather.com/current/london</span>
                    <div style="margin-top: 8px; font-size: 13px; color: var(--muted);">Retrieve current weather data (READ)</div>
                </div>
                
                <div class="endpoint">
                    <div class="method post">POST</div>
                    <span>https://api.example-weather.com/alerts</span>
                    <div style="margin-top: 8px; font-size: 13px; color: var(--muted);">Create a new weather alert (CREATE)</div>
                </div>
                
                <div class="endpoint">
                    <div class="method put">PUT</div>
                    <span>https://api.example-weather.com/alerts/123</span>
                    <div style="margin-top: 8px; font-size: 13px; color: var(--muted);">Update an existing alert (UPDATE)</div>
                </div>
                
                <div class="endpoint">
                    <div class="method delete">DELETE</div>
                    <span>https://api.example-weather.com/alerts/123</span>
                    <div style="margin-top: 8px; font-size: 13px; color: var(--muted);">Remove a weather alert (DELETE)</div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label class="control-label">Try Different Endpoints:</label>
                    <select id="endpointSelect" onchange="updateEndpointDemo()">
                        <option value="current">Current Weather</option>
                        <option value="forecast">5-Day Forecast</option>
                        <option value="historical">Historical Data</option>
                        <option value="alerts">Weather Alerts</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">HTTP Method:</label>
                    <select id="methodSelect" onchange="updateEndpointDemo()">
                        <option value="GET">GET (Retrieve)</option>
                        <option value="POST">POST (Create)</option>
                        <option value="PUT">PUT (Update)</option>
                        <option value="DELETE">DELETE (Remove)</option>
                    </select>
                </div>
            </div>
            
            <div class="response-container">
                <div class="response-header">Example API Response:</div>
                <div class="response-content" id="responseDemo">{
  "location": "London, UK",
  "temperature": 18,
  "description": "Partly cloudy",
  "humidity": 65,
  "wind_speed": 12,
  "timestamp": "2024-01-15T14:30:00Z"
}</div>
            </div>
            
            <button class="btn btn-primary" onclick="showAuthentication()" style="margin-top: 20px;">Next: API Authentication ‚Üí</button>
        </div>
        
        <div class="stage" id="auth-stage" style="display: none;">
            <h2><span class="step-number">2</span>API Authentication & Security</h2>
            <div class="explanation">
                Most APIs require authentication to control access, track usage, and protect resources. API keys and tokens are the most common methods for identifying and authorizing requests.
            </div>
            
            <div class="auth-demo">
                <h4 style="color: var(--indigo); margin: 0 0 15px;">How API Keys Work</h4>
                
                <div style="margin: 20px 0;">
                    <p style="margin: 0 0 15px;">API keys are unique identifiers that authenticate your requests. Think of them like a membership card that proves you're allowed to use the service.</p>
                    
                    <h5 style="color: var(--text); margin: 15px 0 10px;">Example API Request with Key:</h5>
                    <div class="api-key">
                        GET /api/weather/current/london HTTP/1.1<br>
                        Host: api.example-weather.com<br>
                        <strong style="color: var(--indigo);">X-API-Key: wth_9a8b7c6d5e4f3g2h1i0j9k8l7m6n5o4p</strong>
                    </div>
                    
                    <div style="background: rgba(255,193,7,.1); border: 1px solid var(--yellow); border-radius: 8px; padding: 12px; margin: 15px 0;">
                        <p style="margin: 0; font-size: 13px;"><strong>Security Tip:</strong> Never share your API keys publicly or commit them to GitHub. Treat them like passwords!</p>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label class="control-label">Try it yourself:</label>
                    <button class="btn" onclick="generateApiKey()" style="background: var(--blue); color: white;">Generate Practice API Key</button>
                </div>
                <div class="control-group">
                    <label class="control-label">Your Generated Key:</label>
                    <div class="api-key" id="userApiKey">Click button to generate a practice API key</div>
                </div>
            </div>
            
            <div class="api-demo" style="margin-top: 20px;">
                <h5>What happens without a valid key?</h5>
                <button class="btn" onclick="testNoAuth()" id="noAuthBtn">Test Request Without Key</button>
                <button class="btn" onclick="testWithAuth()" id="withAuthBtn" style="margin-left: 10px;">Test Request With Key</button>
                
                <div class="response-container" id="authResponse" style="margin-top: 15px; display: none;">
                    <div class="response-header" id="authResponseHeader">Response:</div>
                    <div class="response-content" id="authResponseContent"></div>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="showRateLimit()" style="margin-top: 20px;">Next: Rate Limiting ‚Üí</button>
        </div>
        
        <div class="stage" id="rate-stage" style="display: none;">
            <h2><span class="step-number">3</span>Rate Limiting & Usage Control</h2>
            <div class="explanation">
                APIs implement rate limiting to prevent abuse, ensure fair usage, and maintain service quality. Rate limits control how many requests you can make within a specific time window.
            </div>
            
            <div class="api-demo">
                <h4 style="color: var(--blue); margin: 0 0 15px;">Rate Limit Information</h4>
                
                <div class="rate-limit">
                    <div class="rate-text">Requests Used:</div>
                    <div class="rate-meter">
                        <div class="rate-fill" id="rateFill" style="width: 30%;"></div>
                    </div>
                    <div class="rate-text" id="rateCount">150 / 500 per hour</div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h5>Common Rate Limit Headers:</h5>
                    <div class="endpoint">
                        X-RateLimit-Limit: 500<br>
                        X-RateLimit-Remaining: 350<br>
                        X-RateLimit-Reset: 1642680000<br>
                        <span style="color: var(--muted);">// Reset time as Unix timestamp</span>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label class="control-label">Simulate API Calls:</label>
                    <button class="btn" onclick="makeApiCall()" id="apiCallBtn">Make API Request</button>
                </div>
                <div class="control-group">
                    <label class="control-label">Request Frequency:</label>
                    <select id="frequencySelect">
                        <option value="slow">Slow (1/sec)</option>
                        <option value="normal">Normal (5/sec)</option>
                        <option value="fast">Fast (10/sec)</option>
                        <option value="burst">Burst (20/sec)</option>
                    </select>
                </div>
            </div>
            
            <div class="response-container" style="display: none;" id="rateLimitResponse">
                <div class="response-header">Rate Limit Exceeded - HTTP 429</div>
                <div class="response-content">{
  "error": "Rate limit exceeded",
  "message": "Too many requests. Limit: 500 per hour",
  "retry_after": 3600
}</div>
            </div>
            
            <button class="btn btn-primary" onclick="showApiExample()" style="margin-top: 20px;">Next: Complete API Example ‚Üí</button>
        </div>
        
        <div class="stage" id="example-stage" style="display: none;">
            <h2><span class="step-number">4</span>Complete API Simulation</h2>
            <div class="explanation">
                Let's put it all together with a simulated weather API that demonstrates REST endpoints, authentication, rate limiting, and error handling. This is a safe practice environment - no real API calls are made.
            </div>
            
            <div style="background: rgba(59,130,246,.1); border: 1px solid rgba(59,130,246,.3); border-radius: 12px; padding: 16px; margin: 20px 0;">
                <h5 style="color: var(--blue); margin: 0 0 8px;">üìù Note: Simulated Environment</h5>
                <p style="margin: 0; font-size: 14px;">This is a simulation showing how real APIs work. No actual API calls are made - all responses are generated locally for learning purposes.</p>
            </div>
            
            <div class="api-demo">
                <h4 style="color: var(--blue); margin: 0 0 15px;">Interactive Weather API Demo</h4>
                
                <div class="controls">
                    <div class="control-group">
                        <label class="control-label">City:</label>
                        <input type="text" id="cityInput" placeholder="Enter city name" value="London">
                    </div>
                    <div class="control-group">
                        <label class="control-label">Data Type:</label>
                        <select id="dataTypeSelect">
                            <option value="current">Current Weather</option>
                            <option value="forecast">5-Day Forecast</option>
                            <option value="alerts">Weather Alerts</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Format:</label>
                        <select id="formatSelect">
                            <option value="json">JSON</option>
                            <option value="xml">XML</option>
                        </select>
                    </div>
                    <div class="control-group" style="display: flex; align-items: end;">
                        <button class="btn btn-primary" onclick="fetchWeatherData()" id="fetchBtn">Fetch Weather Data</button>
                    </div>
                </div>
                
                <div class="endpoint" id="finalEndpoint">
                    <div class="method get">GET</div>
                    <span>https://api.example-weather.com/current/london?format=json</span>
                </div>
            </div>
            
            <div class="response-container" id="weatherResponse">
                <div class="response-header">Click "Fetch Weather Data" to see the API response</div>
                <div class="response-content">Waiting for API request...</div>
            </div>
            
            <div style="background: rgba(255,193,7,.1); border: 1px solid var(--yellow); border-radius: 12px; padding: 16px; margin: 20px 0;">
                <h5 style="color: var(--orange); margin: 0 0 10px;">Best Practices Demonstrated:</h5>
                <ul style="margin: 0; padding-left: 20px;">
                    <li><strong>RESTful URLs:</strong> Clear, predictable endpoint structure</li>
                    <li><strong>Proper HTTP methods:</strong> GET for retrieval, POST for creation</li>
                    <li><strong>Authentication:</strong> API key included in headers</li>
                    <li><strong>Error handling:</strong> Meaningful error messages and status codes</li>
                    <li><strong>Rate limiting:</strong> Respectful request frequency</li>
                </ul>
            </div>
            
            <button class="btn btn-primary" onclick="showSummary()" style="margin-top: 20px;">Next: Summary ‚Üí</button>
        </div>
        
        <div class="intro" id="summary-stage" style="display: none;">
            <h2>Summary</h2>
            <p>You've now explored the complete Web API ecosystem through interactive demonstrations:</p>
            <ul style="margin: 12px 0; padding-left: 20px;">
                <li><strong>REST Fundamentals:</strong> HTTP methods, endpoint design, and resource-based URLs</li>
                <li><strong>Authentication:</strong> API keys, bearer tokens, and secure request methods</li>
                <li><strong>Rate Limiting:</strong> Usage control, quota management, and error handling</li>
                <li><strong>Real Implementation:</strong> Complete API integration with best practices</li>
            </ul>
            
        </div>
    </div>
  </div>
    
    <script>
        let currentRequests = 150;
        let maxRequests = 500;
        let requestInterval;
        
        // Navigation functions for progressive disclosure
        function showRestBasics() {
            document.getElementById('rest-stage').style.display = 'block';
            document.getElementById('rest-stage').scrollIntoView({ behavior: 'smooth' });
        }
        
        function showAuthentication() {
            document.getElementById('auth-stage').style.display = 'block';
            document.getElementById('auth-stage').scrollIntoView({ behavior: 'smooth' });
        }
        
        function showRateLimit() {
            document.getElementById('rate-stage').style.display = 'block';
            document.getElementById('rate-stage').scrollIntoView({ behavior: 'smooth' });
        }
        
        function showApiExample() {
            document.getElementById('example-stage').style.display = 'block';
            document.getElementById('example-stage').scrollIntoView({ behavior: 'smooth' });
        }
        
        function showSummary() {
            document.getElementById('summary-stage').style.display = 'block';
            document.getElementById('summary-stage').scrollIntoView({ behavior: 'smooth' });
        }
        
        // REST Demo Functions
        function updateEndpointDemo() {
            const endpoint = document.getElementById('endpointSelect').value;
            const method = document.getElementById('methodSelect').value;
            const responseDiv = document.getElementById('responseDemo');
            
            const responses = {
                current: {
                    GET: `{
  "location": "London, UK",
  "temperature": 18,
  "description": "Partly cloudy",
  "humidity": 65,
  "wind_speed": 12,
  "timestamp": "2024-01-15T14:30:00Z"
}`,
                    POST: `{
  "error": "Method not allowed",
  "message": "POST not supported for current weather",
  "allowed_methods": ["GET"]
}`
                },
                forecast: {
                    GET: `{
  "location": "London, UK",
  "forecast": [
    {
      "date": "2024-01-15",
      "temperature": {"high": 20, "low": 15},
      "description": "Sunny"
    },
    {
      "date": "2024-01-16", 
      "temperature": {"high": 18, "low": 12},
      "description": "Rainy"
    }
  ]
}`,
                    POST: `{
  "error": "Method not allowed",
  "message": "Cannot POST to forecast - forecasts are read-only",
  "status": 405
}`,
                    PUT: `{
  "error": "Method not allowed",
  "message": "Cannot modify weather forecasts",
  "status": 405
}`,
                    DELETE: `{
  "error": "Method not allowed",
  "message": "Cannot delete weather forecasts",
  "status": 405
}`
                },
                alerts: {
                    GET: `{
  "alerts": [
    {
      "id": "alert_123",
      "type": "weather_warning",
      "severity": "moderate",
      "message": "Heavy rain expected"
    }
  ]
}`,
                    POST: `{
  "success": true,
  "message": "Weather alert created",
  "alert_id": "alert_456"
}`,
                    DELETE: `{
  "success": true,
  "message": "Weather alert deleted"
}`
                }
            };
            
            const response = responses[endpoint]?.[method] || responses[endpoint]?.GET || 
                           `{"error": "Method ${method} not supported for ${endpoint}"}`;
            responseDiv.textContent = response;
        }
        
        // Authentication Demo Functions
        function generateApiKey() {
            const prefixes = ['wth_', 'api_', 'key_'];
            const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
            const chars = '0123456789abcdef';
            let key = prefix;
            for (let i = 0; i < 32; i++) {
                key += chars[Math.floor(Math.random() * chars.length)];
            }
            document.getElementById('userApiKey').textContent = key;
        }
        
        function testNoAuth() {
            const responseDiv = document.getElementById('authResponse');
            const header = document.getElementById('authResponseHeader');
            const content = document.getElementById('authResponseContent');
            
            responseDiv.style.display = 'block';
            header.textContent = 'HTTP/1.1 401 Unauthorized';
            header.style.color = 'var(--red)';
            content.textContent = `{
  "error": "Unauthorized",
  "message": "Missing API key. Please include X-API-Key header",
  "status": 401
}`;
        }
        
        function testWithAuth() {
            const responseDiv = document.getElementById('authResponse');
            const header = document.getElementById('authResponseHeader');
            const content = document.getElementById('authResponseContent');
            
            const apiKey = document.getElementById('userApiKey').textContent;
            if (!apiKey.startsWith('wth_') && !apiKey.startsWith('api_')) {
                alert('Please generate an API key first!');
                return;
            }
            
            responseDiv.style.display = 'block';
            header.textContent = 'HTTP/1.1 200 OK';
            header.style.color = 'var(--emerald)';
            content.textContent = `{
  "success": true,
  "message": "Authenticated successfully",
  "data": {
    "location": "London, UK",
    "temperature": 18,
    "description": "Partly cloudy"
  }
}`;
        }
        
        // Rate Limiting Demo Functions
        function updateRateDisplay() {
            const percentage = (currentRequests / maxRequests) * 100;
            document.getElementById('rateFill').style.width = percentage + '%';
            document.getElementById('rateCount').textContent = `${currentRequests} / ${maxRequests} per hour`;
            
            if (currentRequests >= maxRequests) {
                document.getElementById('rateLimitResponse').style.display = 'block';
                document.getElementById('apiCallBtn').disabled = true;
                document.getElementById('apiCallBtn').textContent = 'Rate Limit Exceeded';
            }
        }
        
        function makeApiCall() {
            if (currentRequests >= maxRequests) return;
            
            const frequency = document.getElementById('frequencySelect').value;
            const increments = { slow: 1, normal: 5, fast: 10, burst: 20 };
            
            currentRequests += increments[frequency];
            if (currentRequests > maxRequests) currentRequests = maxRequests;
            
            updateRateDisplay();
        }
        
        // Weather API Demo Functions
        function fetchWeatherData() {
            const city = document.getElementById('cityInput').value || 'London';
            const dataType = document.getElementById('dataTypeSelect').value;
            const format = document.getElementById('formatSelect').value;
            
            // Update endpoint display
            const endpoint = `https://api.example-weather.com/${dataType}/${city.toLowerCase()}?format=${format}`;
            document.getElementById('finalEndpoint').innerHTML = `
                <div class="method get">GET</div>
                <span>${endpoint}</span>
            `;
            
            // Simulate API response
            const responses = {
                current: {
                    json: `{
  "location": "${city}",
  "temperature": ${15 + Math.floor(Math.random() * 20)},
  "description": "${['Sunny', 'Cloudy', 'Rainy', 'Partly cloudy'][Math.floor(Math.random() * 4)]}",
  "humidity": ${40 + Math.floor(Math.random() * 40)},
  "wind_speed": ${Math.floor(Math.random() * 25)},
  "timestamp": "${new Date().toISOString()}"
}`,
                    xml: `<?xml version="1.0" encoding="UTF-8"?>
<weather>
  <location>${city}</location>
  <temperature>${15 + Math.floor(Math.random() * 20)}</temperature>
  <description>Sunny</description>
  <humidity>${40 + Math.floor(Math.random() * 40)}</humidity>
  <wind_speed>${Math.floor(Math.random() * 25)}</wind_speed>
  <timestamp>${new Date().toISOString()}</timestamp>
</weather>`
                },
                forecast: {
                    json: `{
  "location": "${city}",
  "forecast": [
    {"date": "${new Date().toISOString().split('T')[0]}", "high": 22, "low": 15, "description": "Sunny"},
    {"date": "${new Date(Date.now() + 86400000).toISOString().split('T')[0]}", "high": 19, "low": 12, "description": "Cloudy"},
    {"date": "${new Date(Date.now() + 172800000).toISOString().split('T')[0]}", "high": 21, "low": 14, "description": "Rainy"}
  ]
}`
                },
                alerts: {
                    json: `{
  "location": "${city}",
  "alerts": [
    {
      "id": "alert_${Math.floor(Math.random() * 1000)}",
      "type": "weather_advisory",
      "severity": "low",
      "message": "Mild weather conditions expected",
      "expires": "${new Date(Date.now() + 3600000).toISOString()}"
    }
  ]
}`
                }
            };
            
            const responseContainer = document.getElementById('weatherResponse');
            const response = responses[dataType]?.[format] || responses[dataType]?.json;
            
            responseContainer.innerHTML = `
                <div class="response-header">HTTP/1.1 200 OK - Weather API Response</div>
                <div class="response-content">${response}</div>
            `;
        }
        
        // Initialize
        updateRateDisplay();
        updateEndpointDemo();
    </script>

<footer class="dlab-cta">
  <div class="cta-content">
    <div class="cta-section">
      <h3>Want to go deeper?</h3>
      <p>Learn to work with APIs in our <a href="https://github.com/dlab-berkeley/Python-Fundamentals" target="_blank">Python Fundamentals</a> and <a href="https://github.com/dlab-berkeley/Python-Data-Wrangling" target="_blank">Data Wrangling</a> workshops.</p>
    </div>
    <div class="cta-section">
      <h3>Need help with your research?</h3>
      <p>D-Lab consultants can help you collect and process API data. <a href="https://dlab.berkeley.edu/consulting" target="_blank">Request a consultation</a>.</p>
    </div>
    <div class="cta-section">
      <h3>Stay updated</h3>
      <p>Get notified about new workshops and resources. <a href="https://dlab.berkeley.edu/newsletter" target="_blank">Subscribe to our newsletter</a>.</p>
    </div>
  </div>
</footer>

<style>
.dlab-cta {
  margin-top: 48px;
  padding: 32px;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border-radius: 16px;
  border: 1px solid var(--border);
}
.cta-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 24px;
}
.cta-section h3 {
  margin: 0 0 8px;
  font-size: 1.1em;
  color: var(--text);
}
.cta-section p {
  margin: 0;
  font-size: 0.95em;
  color: var(--muted);
}
.cta-section a {
  color: var(--blue);
  text-decoration: none;
  font-weight: 500;
}
.cta-section a:hover {
  text-decoration: underline;
}
</style>
</body>
</html>